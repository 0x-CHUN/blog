# 计算机组成原理

## 第一章

发展：

1. 第一代：电子管
2. 第二代：晶体管
3. 第三代：中小规模集成电路
4. 第四代：超大规模集成电路

摩尔定律：18个月集成电路上的晶体管翻倍；

通用计算机：巨型机、大型机、中型机、小型机、微型机、单片机

按照指令分类：

* 单指令流单数据流SISD：传统冯诺依曼结构
* 单指令流多数据流SIMD：阵列处理器
* 多指令流单数据流MISD：不存在
* 多指令流多数据流MIMD

### 层次结构

计算机 = 硬件系统 + 软件系统

硬件的基本组成：

* 冯诺依曼机：

  1. 计算机由运算器、存储器、控制器、I/O组成
  2. 指令和数据无区别，均为二进制数据
  3. 指令 = 操作码 + 地址码
  4. 顺序执行

* 功能部件：

  * I/O：键盘、鼠标等；

  * 存储器：存储数据和指令，分为内存和外存；

    地址寄存器MAR：存放有效地址，用于寻址

    数据寄存器MDR：暂存读写的数据

  * 运算器：用于处理数据，核心为算术逻辑单元ALU；

  * 控制器：控制数据、指令的执行，包含PC、IR；

  ![image-20200403144425167](assets/image-20200403144425167.png)

软件的分类：

* 系统软件
* 应用软件

三种级别的语言：（由低到高）

* 机器语言
* 汇编语言
* 高级语言

工作流程：

1. 将数据和指令装入主存
2. 从起始地址开始运行
3. 取指、译码、执行

### 性能指标

吞吐量：单位时间内处理请求的数量；

响应时间：从请求到响应的时间；

时钟周期：CPU的最小时间单位；

主频：时钟的频率，越大性能越好；$f = \frac{1}{T}$

CPI：执行一条指令所需的时钟周期数；

$CPU的执行时间 = \frac{CPI \cdot 指令数}{主频}$

MIPS：每秒执行多少百万指令；$MIPS = \frac{主频}{CPI}$

MFLOPS：每秒执行多少百万次浮点运算；

GFLOPS：每秒执行多少十亿次浮点运算；

## 第二章

r进制数：$(k_{n}k_{n-1}...k_{1})_r = \sum_{i=1}^{n}k_{i} \cdot r^i$

常用进制：十进制、二进制、十六进制

进制转换：

![image-20200403150722220](assets/image-20200403150722220.png)

![image-20200403150753964](assets/image-20200403150753964.png)

小端模式：由低到高存储各个比特；

大端模式：由高到低存储各个比特；

### 校验码

1. 奇偶校验码：码距为2，可检测出一位错误；

2. 海明码：

   $L-1 = D + C  \ (D \geq C)$，其中（L为最小码距，D为检错位数，C为纠错位数）

   步骤：以有效信息为1010，校验位数为3为例

   1. 检验：$n + k \leq 2^k - 1$

   2. 确定校验位分布：

      $p_i$在海明位号位$2^{i-1}$位置上
      $$
      H_7H_6H_5H_4H_3H_2H_1 \\
      D_4D_3D_2P_3D_1P_2P_1
      $$

   3. 分组，形成校验关系

      $D_1$在$H_3$上，$3 = 1 + 2  \ H_1(P_1) \ H_2(P_2)$，所以由$P_2P_1$校验

      $D_2$在$H_5$上，$5 = 1 + 4 \ H_1(P_1) \ H_4(P_3)$，所以由$P_3P_1$校验

      下面的同理；

   4. 校验位取值：由上面分组的

      $P_1 = D_1 \oplus D_2 \oplus D_3$

      依次类推

   5. 校验：

      $S_1 = P_1 \oplus D_1 \oplus D_2 \oplus D_3$

      依此类推

      若$S_3 S_2 S_1 = 000$，则无错，反之$S_3 S_2 S_1$就是错误位的位号；

3. CRC校验码：

   信息位 + 校验位 （K位 + R位）：

   步骤：令生成函数$G(R) = x^3 + x^2 + 1$，信息码为$101001$

   ![image-20200403163030674](assets/image-20200403163030674.png)

   检错和纠错：将收到的CRC码➗G(R)，余数为0，则无错，反之，则余数为错误位的位号；

### 定点数

定点数：小数点位置固定

浮点数：小数点位置不固定

符号数：带符号位的数

定点小数：$x_0.x_1\sim x_n$，数值范围$(-1)^{x_0}(1-2^{-n})$

定点整数：$x_0.x_1\sim x_n$，数值范围$(-1)^{x_0}(2^{n}-1)$

原码：符号位 + 数的绝对值

反码：正数的反码是其本身，负数的反码是在原码的基础上，符号位不变，其他各个位取反；

补码：正数的补码是其本身，负数的补码是在原码的基础上，符号位不变，其他各个位取反后加一；

移码：$[X]_{原码} + 2^n$

运算：

1. 移位：

   * 对于正数：直接添加0
   * 负数：原码添加0，反码直接添加1，补码左移添加0，右移添加1；

2. 逻辑移位：直接添加0

3. 循环移位

4. 原码加减法：

   $[X]_{原码} = X_s.X_1 \sim X_n, \ [Y]_{原码}=Y_s.Y_1 \sim Y_n$

   * 加法：如果$X_s == Y_s$，则直接$X_1 \sim X_n + Y_1 \sim Y_n$，反之则做减法
   * 减法：如果$X_s == Y_s$，则直接相减，反之相加

5. 补码加减法：

   $[X]_{补码} = X_s.X_1 \sim X_n, \ [Y]_{补码}=Y_s.Y_1 \sim Y_n$

   * 加法：$[X+Y]_{补码} = ([X]_{补码} + [Y]_{补码}) \ mod \ 2^{n+1}$
   * 减法：$[X-Y]_{补码} = ([X]_{补码} + [-Y]_{补码}) \ mod \ 2^{n+1}$

6. 溢出：超出表示范围

   判断方法：

   * $[A]_{补码}=A_S A_1 \sim A_n,[B]_{补码}=B_s B_1 \sim B_n$

     $V = A_s B_s \overline{S} + \overline{A}\overline{B}S$，S为结果

     若$V = 0$，则无溢出，反之则溢出；

   * 双符号位

     * $S_{s1}S_{s2} = 00$，表示结果为正数，无溢出；
     * $S_{s1}S_{s2} = 01$，表示结果正溢出
     * $S_{s1}S_{s2} = 10$，表示结果负溢出
     * $S_{s1}S_{s2} = 11$，表示结果为负数，无溢出；

   * 符号位进位$C_s$与最高数位进位$C_1$

     $V = C_s \oplus C_1$，若$V = 0$，则无溢出，反之则溢出；

7. 乘法

   原码乘法：

   ![image-20200403170350661](assets/image-20200403170350661.png)

   补码乘法：

   ​	![image-20200403170408898](assets/image-20200403170408898.png)

### 浮点数

